=== 데이터베이스 드라이버 및 엔진 전략 (최종 확정) ===

1. 최종 결정: SQLAlchemy Async Engine + Asyncpg
   - ORM: SQLAlchemy 2.0 (Async)
   - Driver: asyncpg (PostgreSQL 전용 고성능 비동기 드라이버)
   - Connection Pool: SQLAlchemy Engine 내부 풀링 사용 (NullPool / AsyncAdaptedQueuePool)

2. 이 전략을 선택한 이유 (Raw Psycopg3 Pool 방식 폐기 사유)
   - [안정성] SQLAlchemy Engine은 수년간 검증된 연결 관리 및 트랜잭션 처리 로직을 내장하고 있음.
   - [성능] asyncpg는 현재 파이썬 생태계에서 압도적으로 빠른 PostgreSQL 드라이버임.
   - [유지보수] 직접 Pool을 관리하는 코드를 짤 필요 없이, 엔진 설정(create_async_engine)만으로 완벽한 제어가 가능.
   - [확장성] 추후 ORM 기능이 필요할 때 코드를 갈아엎을 필요 없이 Session만 붙이면 됨. Raw SQL 실행(text 함수)도 완벽 지원.

3. 코드 패턴 가이드
   - SQL 실행: `engine.connect()` 또는 `engine.begin()` 사용.
   - 파라미터 바인딩: `:param` (Named Parameter) 방식 사용. `%s` 아님.
     - 예: `text("SELECT * FROM table WHERE id = :id")`, `{"id": 1}`
   - 결과 매핑: `result.mappings()`를 사용하여 `dict` 형태로 깔끔하게 변환.

4. 의존성 (requirements.txt)
   - sqlalchemy[asyncio]
   - asyncpg
   - (alembic 사용 시 psycopg2-binary 등이 필요할 수 있으나, async 엔진만으로도 구성 가능)

5. 결론
   - "바퀴를 다시 발명하지 말자."
   - 프레임워크(SQLAlchemy)가 제공하는 검증된 기능을 활용하여 비즈니스 로직에 집중한다.
